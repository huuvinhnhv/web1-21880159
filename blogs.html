<!DOCTYPE html>
<html lang="en">

<head>
    <title>21880159 - Web1 Project</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!--favicon-->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <!--Font Awesome-->
    <script src="https://kit.fontawesome.com/3005af10ae.js" crossorigin="anonymous"></script>
    <!--Font-->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Changa+One&display=swap" rel="stylesheet" />
    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous" />
</head>

<body>
    <header class="container">
        <nav class="navbar navbar-expand-sm navbar-light">
            <div class="container">
                <a class="navbar-brand" href="#">
                    <img src="images/logo.png" alt="" />
                </a>
                <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse"
                    data-bs-target="#menu-header" aria-controls="menu-header" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="menu-header">
                    <ul class="navbar-nav ms-auto mt-2 mt-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html" aria-current="page">
                                Home
                                <span class="visually-hidden">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about.html">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="gallery.html">Gallery</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="blogs.html">Blogs</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="contacts.html">Contacts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#modalId">Login</a>
                        </li>
                    </ul>
                    <form class="d-flex my-2 my-lg-0 border rounded-pill" id="form-search">
                        <input class="form-control ms-2 border-0" type="text" placeholder="Search" />
                        <button class="btn my-2 my-sm-0 border-0" type="submit">
                            <i class="fa-solid fa-magnifying-glass"> </i>
                        </button>
                    </form>
                </div>
            </div>
        </nav>
    </header>
    <section id="banner-small"></section>
    <!--Content-->
    <div id="content">
        <section class="container py-5">
            <div class="row">
                <div class="col-8" id="blogs">
                    <!--Handlebars-->
                </div>
                <div class="col-4" id="blogs-categories">
                    <!--Handlebars-->
                </div>
            </div>
        </section>
    </div>
    <!--footer-->
    <footer class="text-center container-fluid text-white py-4">
        <ul class="nav justify-content-center" id="menu-footer">
            <li class="nav-item">
                <a class="nav-link" href="#">Home</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Gallery</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" href="#">Blogs</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Contacts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#modalId">Login</a>
            </li>
        </ul>
        <p class="text-white-50 mt-4">
            Copyright &copy; 2022 by Nguyen Huu Vinh - 21880159
        </p>
    </footer>
    <!--Login Form-->

    <!-- Modal -->
    <div class="modal fade" id="modalId" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <button type="button" class="btn-close float-end" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                    <form action="#" method="post" id="form-login" class="py-5">
                        <h3 class="text-center">Login Form</h3>
                        <div class="mb-3">
                            <input type="text" name="username" id="username" placeholder="Username"
                                class="form-control" />
                        </div>
                        <div class="mb-3">
                            <input type="password" name="password" id="password" placeholder="Password"
                                class="form-control" />
                        </div>
                        <button class="form-control btn" type="submit">Login</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        var modalId = document.getElementById("modalId");

        modalId.addEventListener("show.bs.modal", function (event) {
            // Button that triggered the modal
            let button = event.relatedTarget;
            // Extract info from data-bs-* attributes
            let recipient = button.getAttribute("data-bs-whatever");

            // Use above variables to manipulate the DOM
        });
    </script>

    <!-- Bootstrap JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
        integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz"
        crossorigin="anonymous"></script>
    <!--Web1 CSS-->
    <link rel="stylesheet" href="css/21880159.css" />
    <!--Handlebars-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"
        integrity="sha512-RNLkV3d+aLtfcpEyFG8jRbnWHxUqVZozacROI4J2F1sTaDqo1dPQYs01OMi1t1w9Y2FdbSCDSQ2ZVdAC8bzgAg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="js/handlebars-pagination-helper.js"></script>
    <script src="js/21880159.js"></script>
    <script id="blogs-categories-template" type="text/x-handlebars-template">
      <h1>Categories</h1>
      <ul class="py-3 ps-0">
        {{#each data}}
          <li><a
              href="#"
              class="text-black-50 text-decoration-none"
              onclick="loadBlogs('blogs/categories/{{id}}')"
            >{{name}}</a></li>
        {{/each}}
      </ul>
    </script>
    <script id="blogs-template" type="text/x-handlebars-template">

        <h1>Blogs</h1>
        {{#each data}}
            <div class="clearfix py-3">
                <h3>{{name}}</h3>
                <p class="text-black-50">
                    by {{author}} in 
                    <a href="#" onclick="loadBlogs('blogs/categories/{{category.id}}')">{{category.name}}</a> 
                    on {{formatDate date}}.<a href="#comments" onclick="loadBlogsDetails({{id}}, true)">Comments ({{{comments.length}}})</a> 
                </p>
                <img src="{{thumbpath}}" alt="{{name}}" class="float-start me-3 border rounded-4">
                <p class="text-black-50">{{summary}}</p>
        
                <a href="#" class="btn btn-link readmore ps-0" onclick="loadBlogsDetails({{id}});">Read more</a>
            </div>
        {{/each}}
        {{#pagination currentPage pageCount}}
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    {{#each pages}}
                    {{#if isCurrent}}
                    <li class="page-item active" aria-current="page"><a class="page-link disabled" href="#" onclick="loadBlogs('{{../../request}}',{{page}})">{{page}}</a></li> 
                    {{/if}}
                    {{#unless isCurrent}}
                    <li class="page-item"><a class="page-link" href="#" onclick="loadBlogs('{{../../request}}',{{page}})">{{page}}</a></li>
                    {{/unless}}
                    {{/each}}
                </ul>
            </nav>
            {{/pagination}}   
    </script>
    <script id="details-template" type="text/x-handlebars-template">
        <h1>Blogs</h1>
        {{#each data}}
            <div class="py-3">
                <h3>{{name}}</h3>
                <p>by {{author}} in {{category.name}} on {{formatDate date}}. <a href="#comments" >Comments ({{comments.length}})</a></p>
                <img src="{{imagepath}}" alt="{{name}}" class="float-start me-3 rounded-4 my-2">
                <p>{{{description}}}</p>
            </div>
            <div class="py-3">
                <h3>Leave your comments</h3>
                <form action="#" method="post" class="text-black-50">
                    <div class="row">
                        <div class="col-4">
                            <div class="mb-3">
                                <label for="name" class="form-label">Name (Required)</label>
                                <input type="text" class="form-control" name="name" id="name" placeholder="" required>
                            </div>
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="text" class="form-control" name="email" id="name" placeholder="">
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="mb-3">
                            <textarea class="form-control" name="message" id="message" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="form-check form-check-inline">
                                <input type="checkbox" name="agree" value="1" class="form-check-input">
                                <label class="form-check-label" for="agree">Agree to terms and conditions</label>
                            </div>
                        </div>
                    </div>
                    <div class="col text-end">
                        <button type="submit" class="btn btn-link">Submit Comment</button>
                    </div>
                </form>
            </div>
            <a href="#" name="comments"></a>
            <div class="bg-dark text-white-50">
                COMMENTS ({{comments.length}})
            </div>
            <div class="py-3">
                {{#each comments}}
                <div>
                    <p>{{name}} - {{formatDate date}}</p>
                    <p>{{summary}}</p>
                    <hr/>
                </div>
                {{/each}}
            </div>
        {{/each}}
    </script>
    <script>
        Handlebars.registerHelper('formatDate', function (date) {
            let formatDate = new Date(date);
            let options = {
                weekday: 'short',
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                timeZoneName: 'short'
            }
            return formatDate.toLocaleDateString('en-US', options);
        });
        async function loadBlogs(request, currentPage = 1) {
            const respone = await fetch(`${API}/${request}?page=${currentPage}`);
            const context = await respone.json();
            context.currentPage = currentPage;
            context.request = request

            var source = document.getElementById("blogs-template").innerHTML;
            var template = Handlebars.compile(source);

            var view = document.getElementById("blogs");
            view.innerHTML = template(context);
        }

        loadData(
            "blogs-categories",
            "blogs-categories-template",
            "blogs-categories"
        );
        loadBlogs(
            'blogs'
        );
        async function loadBlogsDetails(blogId, gotoComments = false) {
            await loadData(`blogs/${blogId}`, 'details-template', 'blogs');
            if (gotoComments) {
                window.location.href = "#comments"
            }
        }
    </script>
</body>

</html>